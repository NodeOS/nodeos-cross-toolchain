#!/usr/bin/env bash

set +h

# Clean object dir and return the input error
function err(){
  rm -rf $DEPS_GLIBC
  exit $1
}

#
# Applies OSX "dependencies" needed to compile the linux kernel
#

if [[ $(uname -s) = "Darwin" ]]; then
  command -v port >/dev/null ||
  (
    echo "MacPorts is not installed" &&
    echo "Please visit https://www.macports.org/ for more information" &&
    exit 40
  )

  port -q install gsed || err $?
  ln -s /opt/local/bin/gsed /usr/local/bin/sed  || err $?

  port -q install binutils || err $?
  ln -s /opt/local/bin/gstrip /usr/local/bin/strip  || err $?
fi
